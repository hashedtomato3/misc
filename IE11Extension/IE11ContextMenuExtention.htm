
<script type="text/javascript">
  // for OLD JavaScript Engine
  var toString = Object.prototype.toString;
  Array.prototype.indexOf = function(data) {var idx=-1; for(var i=0; i<this.length; i++){if(this[i]===data){idx=i}} return idx; };
  Array.prototype.forEach = function(fn) {for(var i=0; i<this.length; i++){fn(this[i]);}};
  String.prototype.trim = function() { return this; };
</script>

<script type="text/javascript" src="./csv.min.js"></script>

<script type="text/javascript">
  alert(document.location);

  var win = external.menuArguments;
  //alert(win.document.body);
  alert(win.document.body.innerHTML); // registry = http://localhost/, file://c:/.. both OK
  //alert(win.document.selection);

  var cs = CSV.parse('aaa,bbb,ccc\r\nddd,eee,fff');
  alert(cs);
  cs.forEach(function(a){alert(a);});

  var xhr = new XMLHttpRequest();
  //xhr.open('GET', 'http://www.google.com/', false);  // http://localhost NG,  file://c:/ NG
  xhr.open('GET', 'http://localhost:8080/ttt.htm', false); // http://localhost OK, file://c:/ OK
  xhr.send(null);
  alert(xhr.status);
  alert(xhr.responseText);

  //var selected = win.document.selection.createRange().text;
  //alert("Hello," + selected + " world. ");
</script>


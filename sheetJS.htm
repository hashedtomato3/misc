<script type="text/javascript" src="//unpkg.com/xlsx/dist/shim.min.js"></script>
<script type="text/javascript" src="//unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script type="text/javascript" src="//unpkg.com/blob.js@1.0.1/Blob.js"></script>
<script type="text/javascript" src="//unpkg.com/file-saver@1.3.3/FileSaver.js"></script>

<script>	
	alert(location.href);
	alert(decodeURI(location.href));
//	alert(unescape(location.href));
//	alert(document.getElementsByName("n")[0].value);

	var url = "/static/template.xlsm";

	var req = new XMLHttpRequest();
	req.open("GET", url, true);
	req.responseType = "arraybuffer";

	req.onload = function(e) {
	  var data = new Uint8Array(req.response);
	  var workbook = XLSX.read(data, {type:"array"});

	  // シート
	  var sheet1 = workbook.Sheets["Sheet JS"];

	  //sheet1["A2"] = { t: "s", v: location.href, w: "100" };
	  sheet1["B2"] = { t: "s", v: 200, w: "200" };
	  sheet1["C2"] = { t: "s", v: 300, w: "300" };

  	XLSX.writeFile(workbook, 'SheetJSTableExport.xlsm', {bookType:'xlsm'});
  }

req.send();
</script>

sent
